# Zookeeper: -p 2181:2181 -p 2888:2888 -p 3888:3888
zookeeper:
  image: docker.fenxibao.com/jplock/zookeeper:3.4.5
  ports:
    - "2181:2181"
    
master:
  image: docker.fenxibao.com/redjack/mesos-master:0.21.0
  hostname: master
  links:
    - zookeeper:zookeeper
  environment:
    - MESOS_ZK=zk://zookeeper:2181/mesos
    - MESOS_QUORUM=1
    - MESOS_WORK_DIR=/var/lib/mesos
    - MESOS_LOG_DIR=/var/log
  ports:
    - "5050:5050"
    
marathon:
  image: docker.fenxibao.com/mesosphere/marathon:latest
  links:
    - zookeeper:zookeeper
  ports:
    - "8090:8080"
  # this image does not respect MARATHON_ env variables, so adding the params via command
  command: --master zk://zookeeper:2181/mesos --zk zk://zookeeper:2181/marathon
  
slave:
  image: docker.fenxibao.com/redjack/mesos-slave:0.21.0
  links:
    - zookeeper:zookeeper
    - master:master
  environment:
    - MESOS_MASTER=zk://zookeeper:2181/mesos
    - MESOS_EXECUTOR_REGISTRATION_TIMEOUT=5mins
    - MESOS_LOG_DIR=/var/log
  volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    - /usr/bin/docker:/usr/bin/docker
  expose:
    - "5051:5051"
    
slave5052:
  image: docker.fenxibao.com/redjack/mesos-slave:0.21.0
  links:
    - zookeeper:zookeeper
    - master:master
  environment:
    - MESOS_MASTER=zk://zookeeper:2181/mesos
    - MESOS_EXECUTOR_REGISTRATION_TIMEOUT=5mins
    - MESOS_LOG_DIR=/var/log
  volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    - /usr/bin/docker:/usr/bin/docker
  expose:
    - "5052:5052"
   
chronos:
  image: docker.fenxibao.com/boritzio/docker-chronos:latest
  links:
    - zookeeper:zookeeper
    - master:master
  environment:
    - MESOS_ZK=zk://zookeeper:2181/mesos
    - CHRONOS_ZK=zk://zookeeper:2181
  ports:
    - "8070:8081"
    - "4400:4400"
 
jenkins:
  image: docker.fenxibao.com/csanchez/jenkins-swarm
  hostname: jenkins
  volumes:
    - /var/jenkins_home:/mnt/sda1/jenkins_home
    - /var/run/docker.sock:/var/run/docker.sock
    - /usr/bin/docker:/usr/bin/docker
  ports: 
    - "8080:8080"
    - "50000:50000"
    
jenkinsSlave1:
  image: docker.fenxibao.com/spiddy/dind-jenkins-slave
  links: 
    - jenkins:jenkins
  volumes:
    - /var/run/docker.sock:/var/run/docker.sock

  
jenkinsSlave2:
  image: docker.fenxibao.com/spiddy/dind-jenkins-slave
  links: 
    - jenkins:jenkins
  volumes:
    - /var/run/docker.sock:/var/run/docker.sock
